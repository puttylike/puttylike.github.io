{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/ai-이노베이션-스퀘어-시각-심화-13일차/",
    "result": {"data":{"markdownRemark":{"html":"<p>이번주 중으로 Transfer learning이 마무리 된다.<br>\n오늘은 kaggle data 실습을 했고, 내일은 미니 프로젝트를 진행한다.</p>\n<hr>\n<h3 id=\"13일차\" style=\"position:relative;\">13일차<a href=\"#13%EC%9D%BC%EC%B0%A8\" aria-label=\"13일차 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h5 id=\"복습\" style=\"position:relative;\">복습<a href=\"#%EB%B3%B5%EC%8A%B5\" aria-label=\"복습 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h5>\n<ul>\n<li>Transfer learning</li>\n</ul>\n<p>-> pretrained model, fine tuning<br>\npretrained : VGG16, VGG19, <strong>Mobilenet</strong>, <strong>Xception</strong>, ResNet50, InceptionV3<br>\nfine : slowly change learning rate</p>\n<ul>\n<li>Image Data Generator</li>\n</ul>\n<p>효과도 지정할 수 있긴 한데,<br>\ndir에서 image를 읽어들여 원하는 형태로 출력 이는 게 핵심이다.</p>\n<p>ImageDataGenerator(rescale = 1/255.0, ...)<br>\nrescale이 필수.</p>\n<ul>\n<li>next() 메서드는 iterator 반복 실행자의 또다른 말이다.</li>\n</ul>\n<p>model.fit(train_data, ...) 만으로도 반복 구문이 호출된다.</p>\n<ul>\n<li>effect def</li>\n</ul>\n<ol>\n<li>gen -> rescale(1/255.0, ...)</li>\n<li>gen.from_flow_directory(where, label ...)</li>\n<li>next() -> fit</li>\n</ol>\n<hr>\n<h5 id=\"validation_split\" style=\"position:relative;\">validation_split<a href=\"#validation_split\" aria-label=\"validation_split permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h5>\n<ul>\n<li>data_root_dir</li>\n</ul>\n<p>train, test dir까지 있음 편하다.<br>\nval은 굳이 싶다.<br>\n=> image data generator에 있는 validation_split 를 활용하면 된다.</p>\n<p>data, lavel이 train, val 이면 train data에만 effect를 준다.</p>\n<hr>\n<p>ImageDataGenerator 이용해서 validation data 생성하는 방법을 배워<br>\n지난 주에 배웠던 예제 3 TransferLearning_Example_3_Sparse.ipynb를 변형해 validation_split를 쓰는 예제를 풀었다.</p>\n<p>WIDTH를 224->150으로 줄이면, 학습 속도는 빨라지지만 정확도는 떨어진다. (하이퍼 파라미터)</p>\n<hr>\n<p>(예제 4 없음  !!)</p>\n<hr>\n<h4 id=\"in-kaggle\" style=\"position:relative;\">in kaggle<a href=\"#in-kaggle\" aria-label=\"in kaggle permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>캐글 의료 데이터는 악명 높다.<br>\ntrain 시 99%의 accuracy를 보여도, 실제 test 시 84%가 나온다.<br>\n이런 문제가 생기는 의학 데이터의 특징? insight는?</p>\n<p>=> 테스트 데이터는 학습 때 못 봤던 데이터라서 그렇다.<br>\n학습 데이터의 다양성이 요구되는 이유다.</p>\n<p>자동차만 해도 새로운 종류가 나오면, 금방 알겠는데,<br>\n의학 데이터는 그렇지 못 한다. domain knowledge가 필요하다.<br>\n그래서 전문가 의견을 받아서 다양한 데이터를 확보해야 한다.</p>\n<p>그리고 다른 approach가 필요하다. 이에 대한 근거가 중요하다.<br>\ncf. 딥노이드 / 루닛<br>\n의료 데이터처럼 진입 장벽이 있는 데이터는 돈이 된다. => 비즈니스 !<br>\nData Industry...!<br>\n회사가 AI는 기술력, 돈을 버는 건 Cloud<br>\n안전, 헬스케어 데이터 추천</p>\n<hr>\n<h4 id=\"blood-cell-classification-system\" style=\"position:relative;\">Blood cell Classification System<a href=\"#blood-cell-classification-system\" aria-label=\"blood cell classification system permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>cf. <a href=\"https://www.kaggle.com/paultimothymooney/blood-cells\">https://www.kaggle.com/paultimothymooney/blood-cells</a></p>\n<p>예제 5. dataset2-master 에 있는 파일을 활용하였다.</p>\n<h5 id=\"구글드라이브-mount-하는-이유\" style=\"position:relative;\">구글드라이브 mount 하는 이유<a href=\"#%EA%B5%AC%EA%B8%80%EB%93%9C%EB%9D%BC%EC%9D%B4%EB%B8%8C-mount-%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0\" aria-label=\"구글드라이브 mount 하는 이유 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h5>\n<p>구글드라이브 용도는 data storage라서 channel band witdh가 넓어 데이터를 올릴 수 있는 대역폭이 더 넓다.<br>\ncolab은 아주 좁다. colab에서 데이터를 올리면, 시간이 오래 걸린다.<br>\n=> i/o 작업처럼 사소하지만 오래걸리는 건 pc에서 하는 게 좋다.</p>\n<ul>\n<li>kaggle TIP</li>\n</ul>\n<p>예제 6. train, test 합친 뒤 shuffle하고 나서 split 하면, 데이터 다양성 확보 측면에서 좋다.<br>\n=> 이렇게 하니까 test data accuracy도 99%가 나왔다.</p>\n<p>train으로 옮기는 건 file move이다만,<br>\n합쳐서 shuffle 된 거의 일부를 다시 옮기는 건 file move도 된다만 image data generator로도 가능하다.</p>\n<p>shutil.move할 때 동일한 파일명이 있으면, win os처럼 overwrite하지 않고<br>\nexists error가 난다.\r\nos.path.join을 활용해야 한다.</p>\n<hr>\n<h4 id=\"폐렴-데이터\" style=\"position:relative;\">폐렴 데이터<a href=\"#%ED%8F%90%EB%A0%B4-%EB%8D%B0%EC%9D%B4%ED%84%B0\" aria-label=\"폐렴 데이터 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>cf. <a href=\"https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia\">https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia</a></p>\n<p>1GB 이미지 데이터로 정상, 폐렴 2가지로 분류된다.</p>\n<p>예제7.<br>\n모든 딥러닝은 데이터 수 파악이 기본이다.<br>\n폐렴 데이터는 데이터 수가 몇 천개 밖에 안 된다. => transfer learning</p>\n<p>total_data_nums/train_batch_size하고 나서 math.ceil 반올림해야 데이터를 다 쓸 수 있다.</p>\n<p>위처럼 파일 mv 안 하고 ImageDataGenerator를 이용하니 코드가 더 심플하다.</p>\n<ul>\n<li>3차원 텐서 저장 시 append 아닌 list.extend()를 쓴다.</li>\n</ul>\n<p>[[],[],[]...]</p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#13%EC%9D%BC%EC%B0%A8\">13일차</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#%EB%B3%B5%EC%8A%B5\">복습</a></li>\n<li><a href=\"#validation_split\">validation_split</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#in-kaggle\">in kaggle</a></p>\n</li>\n<li>\n<p><a href=\"#blood-cell-classification-system\">Blood cell Classification System</a></p>\n<ul>\n<li><a href=\"#%EA%B5%AC%EA%B8%80%EB%93%9C%EB%9D%BC%EC%9D%B4%EB%B8%8C-mount-%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0\">구글드라이브 mount 하는 이유</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%ED%8F%90%EB%A0%B4-%EB%8D%B0%EC%9D%B4%ED%84%B0\">폐렴 데이터</a></p>\n</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"AI 이노베이션 스퀘어 3기 심화 시각반 13일차 후기"}}},"pageContext":{"slug":"/ai-이노베이션-스퀘어-시각-심화-13일차/"}},
    "staticQueryHashes": ["3159585216"]}